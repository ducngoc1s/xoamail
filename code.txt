function main() {
    var sheet = SpreadsheetApp.getActiveSpreadsheet().getActiveSheet();
    var lastRow = sheet.getLastRow();
    var userColumn = 1;

    for (var i = 1; i <= lastRow; i++) {
        var userKey = sheet.getRange(i, userColumn).getValue();
        if (userKey) {
            xoaUser(userKey, i);
        }
    }
}
function xoaUser(userKey, rowIndex) {
    var sheet = SpreadsheetApp.getActiveSpreadsheet().getActiveSheet();
    try {
        AdminDirectory.Users.remove(userKey);
        sheet.getRange(rowIndex, 2).setValue('Delete Successfully').setBackground('#1E90FF');
        Logger.log('User has been successfully deleted: ' + userKey);
    } catch (e) {
        sheet.getRange(rowIndex, 2).setValue('Delete Error').setBackground('#FF0000');
        Logger.log('Error while deleting user ' + userKey + ': ' + e.toString());
    }
}
